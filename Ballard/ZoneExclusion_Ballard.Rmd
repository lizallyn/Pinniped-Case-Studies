---
title: "Experiment: Exclusion Zone Implementation @ Ballard"
subtitle: "Describing the model run when an exclusion zone management strategy is implemented at Ballard"
date: "`r format(Sys.time(), '%B %d, %Y')`"
---

### The Narrative

This Model Run is for a scenario where managers in the Gauntlet enact an "Exclusion Zone" management strategy. In this strategy, all pinnipeds that cross into the Gauntlet area when salmon are present in the Gauntlet are targeted for removal. We assume that managers are able to effectively remove a percentage of pinnipeds in the area that is dependent on the total density of pinnipeds.

### Run the Model

```{r, setup, include = FALSE}
library(knitr)
library(flextable)
library(kableExtra)
knitr::opts_knit$set(root.dir = '~/GitHub/PinnipedCaseStudies')
```

```{r setup the model, include = FALSE, message = FALSE, warning = FALSE}

# 01 Set-Up Functions
source("Functions/01_predictFish.R")
source("Functions/makeArray.R")
source("Functions/createHarvestPlan.R")

# 02 Prep Data
source("Ballard/02_Prep_Ballard_salmon_data.R")

# 03 Set Pars
source("Ballard/03_set_pars.R")
```

```{r set pars, message = FALSE, warning = FALSE}
zone_efficiency <- 0.8
zone_steepness <- 5
scenario <- "Zone"
scenario_sealion <- "Zone"
harvest_open <- salmon_days[1]
harvest_close <- salmon_days[length(salmon_days)]
```

```{r run the loop, include = FALSE, echo = FALSE, warning = FALSE, message = FALSE}
# 04 Initialize Variables
source("Ballard/04_initialize_variables.R")

# 05 Loop Functions
source("Ballard/05_salmonSpeciesUpdate.R")
source("Functions/decideForagingDestination.R")
source("Functions/collusion.R")
source("Functions/rungeKutta_3.R")
source("Functions/getHarvested.R")
source("Functions/learnX.R")
source("Functions/learnY.R")
source("Functions/type3FuncRes.R")
source("Functions/linearFuncRes.R")
source("Functions/updateLearning.R")

# 06 Run The Loop
source("Ballard/06_The_Loop.R")

# 07 Plots
source("Functions/makePlots.R")
source("Functions/Plots_Pv.R")
source("Functions/Plots_Ej.R")
source("Functions/Plots_Zc.R")
source("Ballard/07_Plots_salmon.R")
source("Functions/Plots_responses.R")
```

### Description of Parameterization

This scenario is focused on the effects of implementing an Exclusion Zone management strategy in the Ballard Locks. Under this strategy, both seals and sea lions are removed from the Gauntlet by managers. The proportion of pinnipeds that are removed is governed by an efficiency term which describes the asymptote of the type II response between the number of pinnipeds at the Gauntlet and the proportion of individuals removed. That response is shown below:

```{r efficiency plot, echo = FALSE, warning = FALSE, message = FALSE}
num_pinns <- 0:sum(num_seals, num_ej, num_zc)
plot(num_pinns, zone_efficiency * num_pinns/(steepness + num_pinns), ylab = "Proportion of Pinnipeds Harvested", xlab = "Num Pinnipeds @ Gauntlet")
```

In this parameterization, many more pinnipeds are removed from the system than under incidental or boat-based take only. 

```{r harvest table, echo = FALSE}
kable(data.frame(Pv = sum(H), Ej = sum(H_ej), Zc = sum(H_zc)), caption = "Pinnipeds Removed") %>% kable_styling(full_width = F)
```

```{r pinniped harvest plot, echo = FALSE}
plot_H + plot_H_ej + plot_H_zc
```

Because of the increased removals, this scenario has an impact on pinniped behavior, presence at the Gauntlet, and survival. 

```{r pinnipeds at gauntlet, echo = FALSE, warning = FALSE, message = FALSE, fig.height = 9}
plot_seals + plot_zc + plot_ej + plot_layout(guides = "collect", axes = "collect")
```

In the below plots, you can see the impact of removals on 

```{r eaten to probs plots, echo = FALSE, warning = FALSE, message = FALSE, fig.height = 9}
plot_eaten/plot_y/plot_probs + plot_layout(guides = "collect", axes = "collect")
```

### Things to Note

The total escaped Sockeye, Chinook, and Coho are as follows under this parameterization:

```{r, echo = FALSE}
salmon_escapement <- data.frame(Sockeye = escape_sockeye[days], Chinook = escape_chinook[days],
                                Coho = escape_coho[days])
kable(salmon_escapement) %>% kable_styling(full_width = F)
```

This model run has a drastic impact on seal behavior, presence at the Gauntlet, and survival. 
Colors are independent seals.
```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.height = 9}
plot_seals/plot_C/plot_probs/plot_H + plot_layout(guides = "collect", axes = "collect")
```

### Parameter Table

This scenario is focused on the effects of a different management strategy that changes the timing and quantity of seal harvest. Removals occur on all days that salmon are present in the Gauntlet instead of just during days when fishers are active in the area. The harvest strategy is also more aggressive as it is focused on seal removal directly not incidentally as in the base run.

Removals occur from day `r salmon_days[1]` - `r salmon_days[length(salmon_days)]`.  
Removal efficiency is assumed to be `r zone_efficiency * 100`%.

Here's the (kinda) full parameter list:
```{r, echo = FALSE, message = FALSE, warning = FALSE}
parameters <- data.frame(rbind(days, num_seals, zone_efficiency, num_seals_2_copy, sockeye_escape_rate, chinook_escape_rate, coho_escape_rate, min_fishers, max_fishers, fishery_open, fishery_close, sockeye_fish_rate, chinook_fish_rate, coho_fish_rate, natural_mort, Cmax, alpha))
colnames(parameters) <- c("Value")
kable(parameters) %>% kable_styling(full_width = F)
```
