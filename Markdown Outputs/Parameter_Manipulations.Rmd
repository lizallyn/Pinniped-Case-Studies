---
title: "Parameter Manipulation"
output: ioslides_presentation
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(flextable)
library(kableExtra)
```

## Purpose

This presentation is meant to document single parameter manipulations. The main comparison responses are the number of seals at the Gauntlet and the number of salmon escaped total of each species.

## The Base Run Realm

```{r base run realm, message = FALSE, echo = FALSE, warning = FALSE, fig.height = 4, fig.width = 8}
source("Models/Run_The_Model.R", local = knitr::knit_global())
assembleTheLegos(path_to_pars = "Functions/BaseRun_set_pars.R", 
                 path_to_vars = "Functions/BaseRun_initialize_variables.R")
(plot_seals+ theme_classic()) / (eaten_sp_plot+ theme_classic())
salmon_escapement <- data.frame(Sockeye = escape_sockeye[days], Chinook = escape_chinook[days],
                                Coho = escape_coho[days])
kable(salmon_escapement, caption = "Escaped Salmon") %>% kable_styling(full_width = F)
```


## num_seals

```{r num_seals, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

num_seals_list <- seq(from = 1, to = 75, by = 5)

Escape <- data_frame(Seals = 0, Sockeye = 0, Chinook = 0, Coho = 0)
for(i in 1:length(num_seals_list)){
  num_seals <- num_seals_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(Seals = num_seals, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = Seals)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 50, lwd = 2, color = "gray", linetype = 3) +
  labs(y = "Salmon Escaped", x = "Number of Seals in Source Pool") +
  theme_classic()
plot_escape_manipulations

```

Declines to a minimum value, likely governed by the predator dependence/competition level.


## prop_specialists

```{r prop_specialists, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

prop_specialists_list <- seq(0, 1, 0.1)

Escape <- data_frame(Prop = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(prop_specialists_list)){
  prop_specialists <- prop_specialists_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(Prop = prop_specialists, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = Prop)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.1, lwd = 2, color = "gray", linetype = 3) + 
  labs(y = "Salmon Escaped", x = "Proportion of Seal Pop that are Specialists") +
  theme_classic()
plot_escape_manipulations

```

## alpha (search and capture rate)

```{r alpha, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

alpha_list <- seq(0, 1, 0.01)

Escape <- data_frame(Alpha = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(alpha_list)){
  alpha <- alpha_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(Alpha = alpha, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = Alpha)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.05, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "Alpha (Search and Capture") +
  theme_classic()
plot_escape_manipulations
```

## Cmax

```{r Cmax, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

Cmax_list <- seq(1, 15, 0.5)

Escape <- data_frame(Cmax = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(Cmax_list)){
  Cmax <- Cmax_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(Cmax = Cmax, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = Cmax)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 5, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "Cmax") +
  theme_classic()
plot_escape_manipulations
```

## gamma

```{r gamma, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

gamma_list <- seq(-1, 0, 0.05)

Escape <- data_frame(Gamma = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(gamma_list)){
  gamma <- gamma_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(Gamma = gamma, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = Gamma)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = -1, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "gamma") +
  theme_classic()
plot_escape_manipulations
```

## specialist_prob

```{r specialist_prob, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

specialist_prob_list <- seq(0, 1, 0.05)

Escape <- data_frame(specialist_prob = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(specialist_prob_list)){
  specialist_prob <- specialist_prob_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(specialist_prob = specialist_prob, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = specialist_prob)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.5, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "specialist_prob") +
  theme_classic()
plot_escape_manipulations
```

This has pretty much no impact at all, so we could actually probably get rid of this feature completely if we want.

## w (relative goodness of the Gauntlet)

```{r w, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

w_list <- seq(0, 1, 0.05)

Escape <- data_frame(w = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(w_list)){
  w <- w_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(w = w, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = w)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.5, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "w") +
  theme_classic()
plot_escape_manipulations
```

This also has a very small impact, pretty much level.

## intercept_x_val

```{r intercept_x_val, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

intercept_x_val_list <- seq(0, 0.1, 0.001)

Escape <- data_frame(intercept_x_val = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(intercept_x_val_list)){
  intercept_x_val <- intercept_x_val_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(intercept_x_val = intercept_x_val, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = intercept_x_val)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.01, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "intercept_x_val") +
  theme_classic()
plot_escape_manipulations
```

## steepness (y --> Py)

```{r steepness (y), message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

steepness_list <- seq(0, 2.5, 0.1)

Escape <- data_frame(steepness = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(steepness_list)){
  steepness <- steepness_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(steepness = steepness, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = steepness)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.01, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "steepness (y)") +
  theme_classic()
plot_escape_manipulations
```

## threshold_val (y --> Py)

```{r threshold (y), message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

threshold_val_list <- seq(-10, 0, 0.2)

Escape <- data_frame(threshold_val = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(threshold_val_list)){
  threshold_val <- threshold_val_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(threshold_val = threshold_val, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = threshold_val)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.01, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "threshold_val") +
  theme_classic()
plot_escape_manipulations
```

## steepness_x_specialist

```{r steepness_x_specialist, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

steepness_x_specialist_list <- seq(0, 3, 0.2)

Escape <- data_frame(steepness_x_specialist = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(steepness_x_specialist_list)){
  steepness_x_specialist <- steepness_x_specialist_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(steepness_x_specialist = steepness_x_specialist, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = steepness_x_specialist)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.01, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "steepness_x_specialist") +
  theme_classic()
plot_escape_manipulations
```

## threshold_x_specialist

```{r threshold_x_specialist, message = FALSE, echo = FALSE, warning = FALSE, fig.height=4, fig.width = 4}
source("Models/Run_The_Model.R", local = knitr::knit_global())

assembleFirstHalf(path_to_pars = "Functions/BaseRun_set_pars.R")

threshold_x_specialist_list <- seq(0, 10, 0.2)

Escape <- data_frame(threshold_x_specialist = 0, Sockeye = NA, Chinook = NA, Coho = NA)
for(i in 1:length(threshold_x_specialist_list)){
  threshold_x_specialist <- threshold_x_specialist_list[i]
  assembleSecondHalf(path_to_vars = "Functions/BaseRun_initialize_variables.R")
  Escape[i,] <- data_frame(threshold_x_specialist = threshold_x_specialist, salmon_escapement)
}

Escape <- data_frame(Escape)

plot_escape_manipulations <- ggplot(data = Escape, aes(x = threshold_x_specialist)) +
  geom_line(aes(y = Chinook), color = "seagreen", lwd = 1.2) + 
  geom_line(aes(y = Coho), color = "goldenrod", lwd = 1.2) + 
  geom_line(aes(y = Sockeye), color = "salmon", lwd = 1.2) +
  geom_vline(xintercept = 0.01, lwd = 2, color = "gray", linetype = 2) +
  labs(y = "Salmon Escaped", x = "threshold_x_specialist") +
  theme_classic()
plot_escape_manipulations
```

Slight increase


